var EditCtrl = ['$scope','$routeParams','$location','$route','ApiModel','$timeout',
	function($scope,$routeParams,$location,$route,ApiModel,$timeout){
		
		$scope.params = $routeParams;
		$scope.submitting = false;



		// Get Event
		////////////////////////////////////////////////////////////////////////////////
		////////////////////////////////////////////////////////////////////////////////
		$scope.getEvent = function(){

			this.options = {
				type: 'events',
				id: $scope.params.id
			};

			ApiModel.get(this.options,function(data){

				$scope.event = data.event;
				delete $scope.event.description_html;

				$scope.getDays();

			});

		};
		$scope.getEvent();
		////////////////////////////////////////////////////////////////////////////////
		////////////////////////////////////////////////////////////////////////////////



		// Update Event
		////////////////////////////////////////////////////////////////////////////////
		////////////////////////////////////////////////////////////////////////////////
		$scope.saveEvent = function(){

			$scope.submitting = true;

			this.options = {
				type: 'events',
				id: $scope.params.id
			};

			this.Event = new ApiModel({event: $scope.event});

			this.Event.$save(this.options,function(data){

				$scope.submitting = false;

			},function(data){

				$scope.submitting = false;

			});

		};
		////////////////////////////////////////////////////////////////////////////////
		////////////////////////////////////////////////////////////////////////////////


		// Get Days
		////////////////////////////////////////////////////////////////////////////////
		////////////////////////////////////////////////////////////////////////////////
		$scope.getDays = function(){

			var days = dateDiff($scope.event.start_date,$scope.event.end_date);

			$scope.event.days = days;
			$scope.event.nights = (days-1);

		};
		////////////////////////////////////////////////////////////////////////////////
		////////////////////////////////////////////////////////////////////////////////

}];